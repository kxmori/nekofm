"use strict";function MainCtrl(n,t,i,r,u){t.$on("$routeChangeStart",function(){n.loading=!0;Debug.log("Start "+i.path())});t.$on("$routeChangeSuccess",function(){if(n.loading=!1,n.newLocation=i.path(),Debug.log("Success "+i.path()),i.path()=="/radio/search"){Debug.log("けんさく文字列: ["+n.query+"]");var t=i.search();n.query="?"+t.q}});t.$on("$routeChangeError",function(){n.loading=!1;Debug.log("Error "+i.path());i.path()=="/radio"&&i.path("/radio/list")});t.$on("serviceCallStart",function(){n.loading=!0});t.$on("serviceCallEnd",function(){n.loading=!1});t.$on("MusicChanged",function(n,i){t.title=i.title+" - "+i.artist});n.$on("StationListChanged",function(){i.path()!="/radio/list"&&i.path("/radio/list");n.station=r.station()});n.$on("StationChanged",function(){n.station=r.station()});n.brand=u;n.Math=window.Math;n.station=r.station();n.playContext=r.playContext();n.trackSearch=!1;n.dt=new Date;n.doSearch=function(t){t&&n.trackSearch&&(n.trackSearch=!1);var u=t||n.query;n.trackSearch||u.charAt(0)=="?"||u.charAt(0)=="？"?(u=u.replace(/^[?？]*/g,""),u.length>0&&i.path("/radio/search").search({q:u,p:1})):u.length>0&&r.create(u)};n.toggleSearch=function(){n.trackSearch=!n.trackSearch;n.query&&(n.query=n.query.replace(/^[?？]*/g,""),n.trackSearch&&n.query.length>0&&(n.query="?"+n.query))};n.placeHolder=function(){return n.trackSearch?"Search For Music":"Create a New Station"};n.focusCreate=function(){n.trackSearch=!1;n.query="";$(".search-query").focus()};n.debug=function(){r.debug()};n.setBusy=function(){n.loading=!0};n.clearBusy=function(){n.loading=!1};n.checkWelcome=function(){return n.newLocation=="/radio"?"wide":""};n.checkUnknown=function(n){return n?n.artist=="_"?!0:!1:!1};n.stationName=function(){return n.station?n.station.name:""}}function SearchResultCtrl(n,t,i){Debug.log("けんさくけっかーーーーーーーーーーーーーーー");Debug.dir(i);n.results=i;n.checkNext=function(){return n.results.page<parseInt((n.results.totalResults-1)/30)+1};n.play=function(i){var r=n.results.tracks[i];t.playNow(r.artist,r.title)}}function PlayerCtrl(n,t,i){Debug.log("ぷれーやーーーーーーーーーーーーーーーー");n.settings=i.playerSettings();n.toggleFade=function(){n.settings.crossFade=!n.settings.crossFade;n.settings.crossFade&&n.settings.repeat&&(n.settings.repeat=!1);i.playerSettings(n.settings)};n.toggleRepeat=function(){n.settings.crossFade||(n.settings.repeat=!n.settings.repeat,i.playerSettings(n.settings))};n.show=!0;n.toggleShow=function(){n.show=!n.show};n.eyeIcon=function(){return n.show?"icon-eye-close":"icon-eye-open"};n.eyeTitle=function(){return n.show?"Hide YouTube Player":"Show YouTube Player"};n.checkReady=function(){return n.playContext.playerState&&n.playContext.playerState!=-1};n.doPause=function(){i.pause()};n.doNext=function(){i.doNext()};n.addFavorite=function(){i.addFavorite();t.path("/radio/favorite")};n.addDonot=function(){i.addDonot();i.doNext()};n.editing=!1;n.$on("MusicChanged",function(){n.editing=!1});n.startEditing=function(){if(n.editing){n.editing=!1;return}var t=i.getVideoId();t?(n.videoId=t.id,n.stSec=t.stSec):(n.videoId=null,n.stSec=null);n.errorMessage="";n.editing=!0};n.doAdjust=function(){var r,t;if(n.videoId!=null){if(n.videoId.length==0){i.setVideoId(null,n.videoId,n.stSec);n.editing=!1;return}if(r=i.getPlaybackStatus(),r.videoId==t){i.setVideoId(null,n.videoId,n.stSec);n.editing=!1;return}t=n.videoId.replace(/(^\s+)|(\s+$)/g,"");i.getVideoTitle(t,function(){i.setVideoId(null,t,n.stSec);n.$apply(n.onLostFocus)},function(t){n.$apply(function(){n.errorMessage=t})})}};n.onLostFocus=function(){n.editing=!1};n.onSetStartSec=function(){var t=i.getPlaybackStatus();t&&(n.stSec=t.currentTime,n.videoId=t.videoId)};n.onResetStartSec=function(){n.stSec=null};n.changed=function(){n.errorMessage=""};n.dontPlay=function(){i.addDonotById();i.doNext();n.editing=!1}}function StationListCtrl(n,t,i){function r(r){Debug.log("すてーしょんりすとーーーーーーーーーーーーーーー");n.stationList=angular.copy(i.stationList());Debug.log("stationListの長さ"+Object.keys(n.stationList).length);Object.keys(n.stationList).length==0&&t.path("/radio");for(var u in n.stationList)r!=null&&r==u?(n.stationList[u].editing=!0,Debug.log("StationList 編集 : "+u)):n.stationList[u].editing=!1}r();n.$on("StationListChanged",function(n,t){r(t)});n.startEditing=function(t){n.stationList[t].editing=!0};n.doRename=function(t){var r=n.stationList[t].name.replace(/(^\s+)|(\s+$)/g,"");r.length>0?i.renameStation(t,r):n.stationList[t].name=angular.copy(i.stationList()[t].name);n.stationList[t].editing=!1};n.onLostFocus=function(t){n.stationList[t].name=angular.copy(i.stationList()[t].name);n.stationList[t].editing=!1};n.changeStation=function(r){n.stationList[r].name==n.stationName()?t.path("radio/config"):i.changeStation(r)};n.removeStation=function(t){window.confirm("Are you sure you want to remove the following station?\n\n"+n.stationList[t].name)&&i.removeStation(t)};n.newStation=function(){n.focusCreate()}}function ArtistDetailCtrl(n,t,i){Debug.log("あーてぃすとしょうさいーーーーーーーーーーーーーーー");n.artist=i;n.play=function(i){t.playNow(n.artist.name,n.artist.songs[i].name)};n.$on("artistSongsUpdate",function(){n.clearBusy()});n.getMoreSongs=function(){n.setBusy();t.getTracks(n.artist)};n.setSongCount=function(i){t.setSongCount(n.artist,i+1)};n.getSongCount=function(){return t.getSongCount(n.artist)}}function ArtistTracksCtrl(n,t,i){Debug.log("あーてぃすと　とらっくーーーーーーーーーーーーーーー");n.artist=i;n.play=function(i){t.playNow(n.artist.name,n.artist.songs[i].name)};n.$on("artistSongsUpdate",function(){n.clearBusy()});n.getMoreSongs=function(){n.setBusy();t.getTracks(n.artist)}}function ConfigCtrl(n,t,i,r){Debug.log("こんふぃぐーーーーーーーーーーーーーーー");n.artists=r.artists;n.addArtist=function(){i.addArtist(n.newArtist,10)};n.removeArtist=function(n){i.removeArtist(n,1)};n.dirty=!1;n.changed=function(){n.dirty||(n.dirty=!0,t(function(){i.doSaveStation();n.dirty=!1},3e3))};n.thumbsUp=function(t){n.artists[t].match<10&&(n.artists[t].match++,n.changed())};n.thumbsDown=function(t){n.artists[t].match>0&&(n.artists[t].match--,n.changed())};n.artists.forEach(function(n){n.editing=!1});n.startEditing=function(t){n.artists[t].editing=!0};n.doAdjust=function(t){n.artists[t].editing=!1};n.onLostFocus=function(t){n.artists[t].editing=!1}}function SongHistoryCtrl(n,t,i){Debug.log("ひすとりーーーーーーーーーーーーーーー");n.history=i;n.play=function(i){var r=n.history[i];t.playNow(r.artist,r.title)}}function FavoriteListCtrl(n,t,i){Debug.log("おきにいりーーーーーーーーーーーーーーー");n.favorites=i;n.playIcon=function(i){if(n.station){var r=t.getStationId().id;return i.tags.indexOf(r)!=-1?"img/Music-Green.png":"img/Music-Grey.png"}};n.togglePlay=function(i){if(n.station){var r=t.getStationId().id;i.tags.indexOf(r)!=-1?t.removeFavorite(i):t.addFavorite(i)}};n.checkStation=function(){return n.station?!0:!1};n.play=function(n){t.playNow(n.artist,n.title)};n.remove=function(n){t.removeFavorite(n,!0)};n.playAll=function(){t.playFavorites()};n.editing=!1;n.startEditing=function(){if(n.editing){n.editing=!1;return}n.videoId="";n.track={artist:"",title:""};n.errorMessage="";n.editing=!0};n.add=function(){t.addFavoriteAs(n.videoId,n.track,function(){n.$apply(n.onLostFocus)},function(t){n.$apply(function(){n.errorMessage=t})})};n.onLostFocus=function(){n.editing=!1};n.changed=function(){n.errorMessage=""}}function DonotListCtrl(n,t,i){Debug.log("再生しないでーーーーーーーーーーーーーーー");n.donots=i;n.play=function(n){t.playNow(n.artist,n.title)};n.remove=function(n){t.removeDonot(n)}}MainCtrl.$inject=["$scope","$rootScope","$location","Radio","Brand"];SearchResultCtrl.$inject=["$scope","Radio","results"];PlayerCtrl.$inject=["$scope","$location","Radio"];StationListCtrl.$inject=["$scope","$location","Radio"];ArtistDetailCtrl.$inject=["$scope","Radio","artist"];ArtistTracksCtrl.$inject=["$scope","Radio","artist"];ConfigCtrl.$inject=["$scope","$timeout","Radio","station"];SongHistoryCtrl.$inject=["$scope","Radio","history"];FavoriteListCtrl.$inject=["$scope","Radio","favorites"];DonotListCtrl.$inject=["$scope","Radio","donots"];